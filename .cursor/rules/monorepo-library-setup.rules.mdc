---
description: 
globs: 
alwaysApply: true
---
# When creating a new library or converting to our pnpm workspaces setup:

## Monorepo Folder Purposes

```txt
/apps - executable libraries that consume packages
/packages - libraries that export their functionality to be consumed by apps
/tooling - libraries consumed by apps and packages to setup shared monorepo tooling
```

## Monorepo naming patterns

/apps - @[app-name]/*
/packages - @[app-name]/*
/tooling - @kit/*

## IF the library is an app in the ./apps folder

1. In the package.json:
```json
   {
    "name": "@[app-name]/[package-name]",
    "scripts": {
      "clean": "git clean -xdf .turbo node_modules",
      "format": "prettier --check \"**/*.{ts,tsx}\"",
      "lint": "eslint .",
      "typecheck": "tsc --noEmit",
    },
    "devDependencies": {
      "@kit/tsconfig": "workspace:*",
      "@kit/eslint-config": "workspace:*",
      "@kit/prettier-config": "workspace:*"
    },
    "eslintConfig": {
      "root": true,
      "extends": [
        "@kit/eslint-config/base", // default settings
        "@kit/eslint-config/react", // only if a react library
        "@kit/eslint-config/sort" // enables import and object key sorting
      ]
   },
   "prettier": "@kit/prettier-config"
}
```

2. The tsconfig default should be:

```json
{
  "extends": "@kit/tsconfig/base",
  "compilerOptions": {
    "tsBuildInfoFile": "node_modules/.cache/tsbuildinfo.json",
    "baseUrl": ".",
    "paths": {}
  },
  "include": [
    "*.ts",
    "*.tsx",
    "*.css",
    "src",
    "src/**/*.d.ts",
    "*.d.ts"
  ],
  "exclude": [
    "node_modules",
  ]
}
```

## IF the library is in the ./packages/* folder in addition to everything above

1. The package.json needs exports

```json
  "name": "@[app-name]/[package-name]",
  "exports": {
    ".": "./src/index.ts",
    "./types": "./src/types/index.ts"
  },
```

## Cleanup

1. We don't need any eslint, typescript, or prettier related packages or types in the package.json besides our local tooling packages

## Notes

1. The workspace tooling looks like this:

```txt
ğŸ“ tooling
    â”œâ”€â”€ ğŸ“ eslint
â”‚   â”œâ”€â”€ ğŸ“ prettier
â”‚   â”œâ”€â”€ ğŸ“ testing
â”‚   â””â”€â”€ ğŸ“ tsconfig
```

2. tooling

```json
  "name": "@kit/[package-name]",
  "exports": {
    ".": "./src/index.ts",
    "./types": "./src/types/index.ts"
  },
```

2. pnpm workspaces settings for reference

```yaml
packages:
  - 'apps/*'
  - 'packages/*'
  - 'tools/*'
```  