---
description: 
globs: 
alwaysApply: true
---
# When creating a new library or converting to our pnpm workspaces setup:

## Monorepo Folder Purposes

```txt
/apps - executable libraries that consume packages
/packages - libraries that export their functionality to be consumed by apps
/tooling - libraries consumed by apps and packages to setup shared monorepo tooling
```

## IF the library is an app in the ./apps folder

1. In the package.json:
```json
   {
    "scripts": {
      "clean": "git clean -xdf .turbo node_modules",
      "format": "prettier --check \"**/*.{ts,tsx}\"",
      "lint": "eslint .",
      "typecheck": "tsc --noEmit",
    },
    "devDependencies": {
      "@kit/tsconfig": "workspace:*",
      "@kit/eslint-config": "workspace:*",
      "@kit/prettier-config": "workspace:*"
    },
    "eslintConfig": {
      "root": true,
      "extends": [
        "@kit/eslint-config/base", // default settings
        "@kit/eslint-config/react", // only if a react library
        "@kit/eslint-config/sort" // enables import and object key sorting
      ]
   },
   "prettier": "@kit/prettier-config"
}
```

2. The tsconfig default should be:

```json
{
  "extends": "@kit/tsconfig/base",
  "compilerOptions": {
    "tsBuildInfoFile": "node_modules/.cache/tsbuildinfo.json",
    "baseUrl": ".",
    "paths": {}
  },
  "include": [
    "*.ts",
    "*.tsx",
    "*.css",
    "src",
    "src/**/*.d.ts",
    "*.d.ts"
  ],
  "exclude": [
    "node_modules",
  ]
}
```

## IF the library is in the ./packages/* folder in addition to everything above

1. The package.json needs exports

```json
  "exports": {
    ".": "./src/index.ts",
    "./types": "./src/types/index.ts"
  },
```

## Cleanup

1. We don't need any eslint, typescript, or prettier related packages or types in the package.json besides our local tooling packages

## Notes

1. The workspace tooling looks like this:

```txt
📁 tooling
    ├── 📁 eslint-config
│       ├── 📄 eslint-config/base.js
│   │   ├── 📄 eslint-config/index.js
│   │   ├── 📁 eslint-config/node_modules
│   │   │   ├── 📁 eslint-config/node_modules/@typescript-eslint
│   │   │   │   ├── 📄 eslint-config/node_modules/@typescript-eslint/eslint-plugin
│   │   │   │   └── 📄 eslint-config/node_modules/@typescript-eslint/parser
│   │   │   ├── 📄 eslint-config/node_modules/eslint
│   │   │   ├── 📄 eslint-config/node_modules/eslint-config-prettier
│   │   │   ├── 📄 eslint-config/node_modules/eslint-plugin-import
│   │   │   └── 📄 eslint-config/node_modules/eslint-plugin-simple-import-sort
│   │   ├── 📄 eslint-config/package.json
│   │   └── 📄 eslint-config/sort.js
│   ├── 📁 prettier-config
│   │   ├── 📄 prettier-config/index.json
│   │   └── 📄 prettier-config/package.json
│   └── 📁 tsconfig
│       ├── 📄 tsconfig/base.json
│       ├── 📄 tsconfig/node.json
│       └── 📄 tsconfig/package.json
```

2. pnpm workspaces settings for reference

```yaml
packages:
  - 'apps/*'
  - 'packages/*'
  - 'tools/*'
```  